<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday, Shriti!</title>
    
    <!-- External Libraries -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&family=Josefin+Sans:wght@400;700&family=Dancing+Script:wght@700&family=Orbitron:wght@700&display=swap" rel="stylesheet">

    <style>
        /* --- Base Styles & Theme --- */
        :root {
            --bg-lightest: #fde6ec;
            --bg-medium: #f9c5d1;
            --bg-dark: #fcd4e0;
            --text-dark: #4A4A4A;
            --text-light: #ffffff;
            --font-title: 'Playfair Display', serif;
            --font-ui: 'Josefin Sans', sans-serif;
            --font-body: 'Poppins', sans-serif;
            --font-signature: 'Dancing Script', cursive;
            --font-circular: 'Orbitron', sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
            color: var(--text-dark);
            font-family: var(--font-body);
            overflow: hidden;
            height: 100vh;
        }

        /* --- Page Container & Transitions --- */
        .page-container {
            position: relative;
            width: 100%;
            height: 100%;
            perspective: 1500px;
        }

        .page {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            box-sizing: border-box;
            backface-visibility: hidden;
            transform-style: preserve-3d;
            transition: transform 1.5s cubic-bezier(0.77, 0, 0.175, 1), opacity 1.5s ease-in-out;
            opacity: 0;
            transform: translateY(100vh) rotateX(-90deg);
            transform-origin: center bottom;
        }

        .page.active {
            opacity: 1;
            transform: translateY(0) rotateX(0deg);
        }
        
        /* --- Page 0: Pre-loader --- */
        #page-preloader {
            background-color: #000000;
            color: var(--text-light);
            transform: translateY(0) rotateX(0deg);
        }
        #preloader-content { position: relative; z-index: 10; }
        #surprise-text-signature {
            font-family: var(--font-signature);
            font-size: clamp(3rem, 10vw, 6rem);
            color: #fff;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px #f9c5d1, 0 0 20px #f9c5d1;
        }
        #surprise-text-circular {
            font-family: var(--font-circular);
            font-size: clamp(1rem, 4vw, 1.5rem);
            letter-spacing: 2px;
            color: #eee;
            text-transform: uppercase;
        }
        #volume-btn {
            margin-top: 2.5rem;
            padding: 15px 30px;
            font-family: var(--font-ui);
            font-size: 1.2rem;
            color: #fff;
            background: #222;
            border: 2px solid #444;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s ease-out;
            box-shadow: 0 5px 0 #111;
        }
        #volume-btn:active { transform: translateY(5px); box-shadow: 0 0px 0 #111; }
        #time-travel-container {
            display: none;
            font-family: var(--font-circular);
            font-size: clamp(1.5rem, 5vw, 3rem);
            color: #0f0;
            text-shadow: 0 0 8px #0f0;
        }

        /* --- Typography --- */
        h1, h2, h3 { margin: 0; padding: 0; transition: all 0.3s ease; z-index: 5; }
        h1 { font-family: var(--font-title); font-size: clamp(2.5rem, 10vw, 5rem); color: var(--text-dark); }
        h2 { font-family: var(--font-body); font-size: clamp(1.2rem, 5vw, 1.8rem); font-weight: 300; margin-top: 1rem; color: var(--text-dark); }
        h1:hover, h2:hover { transform: scale(1.02); letter-spacing: 1px; }

        /* --- Page 1: Rose Petals --- */
        #page-loader { background-color: var(--bg-lightest); }
        #petal-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 1; }
        .petal { position: absolute; top: -50px; width: 20px; height: 20px; background-color: #f7a7b9; border-radius: 1px 15px; opacity: 0.8; animation: fall linear infinite; }
        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.8; }
            100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
        }

        /* --- Page 2: Cake Page --- */
        #page-candle { background-color: var(--bg-medium); justify-content: flex-start; padding-top: 5%; }
        #page-candle .cake-top-text { width: 100%; transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out; }
        #page-candle .cake-top-text.hidden { transform: translateY(-50px); opacity: 0; }
        #page-candle #wishMessage { position: absolute; top: 10%; opacity: 0; transform: translateY(-50px); transition: transform 0.8s cubic-bezier(0.215, 0.610, 0.355, 1), opacity 0.8s ease; }
        #page-candle #wishMessage.visible { opacity: 1; transform: translateY(0); }
        #page-candle #wishMessage h2 { font-family: var(--font-ui); font-size: clamp(1.5rem, 6vw, 2.5rem); }
        #cutMeBtn { position: absolute; bottom: 10%; left: 50%; transform: translateX(-50%) translateY(100px); opacity: 0; transition: all 0.8s cubic-bezier(0.215, 0.610, 0.355, 1); z-index: 100; }
        #cutMeBtn.visible { transform: translateX(-50%) translateY(0); opacity: 1; }
        .smooth-btn { background: rgba(255, 255, 255, 0.4); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.6); padding: 12px 24px; color: var(--text-dark); font-family: var(--font-body); font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); }
        .smooth-btn:hover { transform: scale(1.05) !important; letter-spacing: 1px; background: rgba(255, 255, 255, 0.6); }

        /* --- New 3D Animated Chocolate Cake --- */
        .cake-container-3d {
            position: absolute;
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            transform-style: preserve-3d;
            animation: cake-bob 4s ease-in-out infinite;
        }
        @keyframes cake-bob {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }
        .cake-3d {
            position: relative;
            width: 220px;
            height: 150px; /* Increased height for visual thickness */
            transform-style: preserve-3d;
            transform: rotateX(75deg) rotateZ(-25deg); /* Increased rotation for more 3D effect */
        }
        .cake-side {
            position: absolute;
            width: 220px;
            height: 150px; /* Increased height */
            background: linear-gradient(to right, #6b4a3a, #4b2e21);
            border-radius: 50%;
        }
        .cake-top {
            position: absolute;
            width: 220px;
            height: 150px; /* Increased height */
            background: #4b2e21;
            border-radius: 50%;
            transform: translateZ(40px); /* Increased thickness */
            box-shadow: 0 0 20px rgba(0,0,0,0.5) inset;
        }
        .cake-icing-drip {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, transparent 40%, #f9c5d1 41%, #f9c5d1 45%, transparent 46%);
            transform: translateZ(41px); /* Adjusted for thickness */
        }
        .cake-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) translateZ(42px); /* Adjusted for thickness */
            font-family: var(--font-signature);
            font-size: 1.5rem;
            color: #fde6ec;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            white-space: nowrap;
        }
        .candles-3d {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transform: translateZ(41px); /* Adjusted for thickness */
        }
        .candle-3d {
            position: absolute;
            width: 10px;
            height: 50px;
            background: repeating-linear-gradient(45deg, #fff, #fff 4px, #f9c5d1 4px, #f9c5d1 8px);
            transform-style: preserve-3d;
        }
        /* Positioning candles on the ellipse */
        .candle-3d:nth-child(1) { top: 45px; left: 105px; }
        .candle-3d:nth-child(2) { top: 65px; left: 155px; }
        .candle-3d:nth-child(3) { top: 90px; left: 135px; }
        .candle-3d:nth-child(4) { top: 85px; left: 65px; }
        .candle-3d:nth-child(5) { top: 60px; left: 50px; }
        
        .flame-3d {
            position: absolute;
            top: -18px;
            left: 50%;
            width: 12px;
            height: 18px;
            background: #ffc83d;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            transform-origin: bottom center;
            animation: realistic-flame 1s ease-in-out infinite;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .flame-3d.lit { opacity: 1; }
        @keyframes realistic-flame {
            0% { transform: translateX(-50%) scale(1) skewX(0deg); opacity: 0.9; }
            25% { transform: translateX(-45%) scale(1.05) skewX(5deg); opacity: 1; }
            50% { transform: translateX(-50%) scale(0.95) skewX(0deg); opacity: 0.8; }
            75% { transform: translateX(-55%) scale(1.02) skewX(-5deg); opacity: 1; }
            100% { transform: translateX(-50%) scale(1) skewX(0deg); opacity: 0.9; }
        }

        /* --- Page 3: Photos --- */
        #page-photos { background-color: var(--bg-dark); }
        .swiper-container { width: 100%; padding-top: 50px; padding-bottom: 50px; }
        .swiper-slide { background-position: center; background-size: cover; width: 300px; height: 400px; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); background-color: #fff; border: 1px solid var(--border-soft); position: relative; }
        .swiper-slide img { display: block; width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease; }
        .swiper-slide:hover img { transform: scale(1.1); }
        .slide-quote { position: absolute; bottom: 0; left: 0; right: 0; padding: 15px; background: linear-gradient(to top, rgba(0,0,0,0.7), rgba(0,0,0,0)); color: white; font-family: var(--font-body); font-size: 0.75rem; text-align: center; opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease; transition-delay: 0.3s; }
        .swiper-slide-active .slide-quote { opacity: 1; transform: translateY(0); }

        /* --- Page 4: Diary --- */
        #page-diary { background-color: var(--bg-lightest); }
        .diary-container { background: rgba(255, 255, 255, 0.3); backdrop-filter: blur(5px); border: 1px solid var(--border-soft); border-radius: 15px; padding: 2rem; width: 90%; max-width: 800px; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1); }
        #diary-text { font-family: var(--font-body); font-size: clamp(1rem, 3vw, 1.3rem); color: var(--text-dark); text-align: left; min-height: 250px; }
        #diary-text .typed-cursor { color: var(--text-dark); }
        .signature { font-family: var(--font-signature); font-size: clamp(1.5rem, 4vw, 2.2rem); text-align: right; display: block; margin-top: 1.5rem; color: #c78b9b; font-weight: 700; }

        /* --- Page 5: Final Wish --- */
        #page-final { background-color: var(--bg-medium); }
        #final-video-btn {
            font-family: var(--font-title);
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            padding: 20px 40px;
            cursor: pointer;
            border-radius: 20px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.4);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        #final-video-btn:hover {
            transform: scale(1.05);
            background: rgba(255,255,255,0.4);
        }

        /* --- Page 6: Video Page --- */
        #page-video { background-color: #000; }
        #final-video {
            max-width: 90%;
            max-height: 90%;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 182, 193, 0.5);
        }

    </style>
</head>
<body>
    <audio id="bg-audio" loop>
        <source src="https://res.cloudinary.com/dqh7olosv/video/upload/v1754127757/lv_0_20250802150406_j4x58n.mp3" type="audio/mpeg">
    </audio>

    <div class="page-container">
        
        <!-- Page 0: Pre-loader -->
        <section id="page-preloader" class="page active">
            <div id="preloader-content">
                <div id="surprise-text-signature">Surprise !!!</div>
                <div id="surprise-text-circular">Ok, Volume Up And Watch</div>
                <button id="volume-btn">üîä Volume On</button>
            </div>
            <div id="time-travel-container">
                <span id="date-display"></span>
            </div>
        </section>

        <!-- Page 1: Initial Loader/Greeting -->
        <section id="page-loader" class="page">
            <div id="petal-container"></div>
            <h1>Happy Birthday</h1>
            <h2>My Dearest Shriti</h2>
        </section>

        <!-- Page 2: Interactive Cake -->
        <section id="page-candle" class="page">
            <div class="cake-top-text">
                <h1 style="font-family: var(--font-ui);">Happy Birthday!</h1>
                <h2 style="font-family: var(--font-body);">Shriti</h2>
            </div>
            <div id="wishMessage"><h2>Make a wish, Shriti...</h2></div>
            <button id="cutMeBtn" class="smooth-btn">üéÇ Cut Me</button>
            
            <!-- New 3D Animated Cake -->
            <div class="cake-container-3d">
                <div class="cake-3d">
                    <div class="cake-side"></div>
                    <div class="cake-top"></div>
                    <div class="cake-icing-drip"></div>
                    <div class="cake-text">Happy Birthday Shriti ‚ù§Ô∏è</div>
                    <div class="candles-3d">
                        <div class="candle-3d"><div class="flame-3d"></div></div>
                        <div class="candle-3d"><div class="flame-3d"></div></div>
                        <div class="candle-3d"><div class="flame-3d"></div></div>
                        <div class="candle-3d"><div class="flame-3d"></div></div>
                        <div class="candle-3d"><div class="flame-3d"></div></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Page 3: Photo Slideshow -->
        <section id="page-photos" class="page">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <img src="https://res.cloudinary.com/dqh7olosv/image/upload/v1754127827/IMG-20250802-WA0012_x76meo.jpg" alt="Memory 1">
                        <div class="slide-quote">You‚Äôre not just my birthday wish ‚Äî you‚Äôre my every wish come true.</div>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://res.cloudinary.com/dqh7olosv/image/upload/v1754127839/IMG-20250802-WA0011_fnhm6e.jpg" alt="Memory 2">
                        <div class="slide-quote">With every heartbeat, I fall for you all over again.</div>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://res.cloudinary.com/dqh7olosv/image/upload/v1754127851/IMG-20250802-WA0015_cwrjgk.jpg" alt="Memory 3">
                        <div class="slide-quote">Your smile is my favorite reason to exist.</div>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://res.cloudinary.com/dqh7olosv/image/upload/v1754127863/IMG-20250802-WA0013_j4kd5d.jpg" alt="Memory 4">
                        <div class="slide-quote">In you, I found the kind of love people write poems about.</div>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://res.cloudinary.com/dqh7olosv/image/upload/v1754127878/IMG-20250802-WA0014_jdpvp1.jpg" alt="Memory 5">
                        <div class="slide-quote">Every moment with you feels like a beautiful forever.</div>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://res.cloudinary.com/dqh7olosv/image/upload/v1754127890/IMG-20250802-WA0010_c4iee4.jpg" alt="Memory 6">
                        <div class="slide-quote">You didn‚Äôt just steal my heart ‚Äî you made it your home.</div>
                    </div>
                </div>
                <div class="swiper-pagination"></div>
            </div>
        </section>

        <!-- Page 4: Diary/Message -->
        <section id="page-diary" class="page">
            <div class="diary-container">
                <span id="diary-text"></span>
            </div>
        </section>

        <!-- Page 5: Final Wish -->
        <section id="page-final" class="page">
            <div id="final-video-btn">This One For You</div>
        </section>

        <!-- Page 6: Final Video -->
        <section id="page-video" class="page">
            <video id="final-video" src="https://res.cloudinary.com/dqh7olosv/video/upload/v1754150608/VID-20250802-WA0054_nje8sb.mp4" controls playsinline></video>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const pages = document.querySelectorAll('.page');
            let currentPageIndex = 0;
            let swiper, typed;

            const audio = document.getElementById('bg-audio');
            const volumeBtn = document.getElementById('volume-btn');
            const preloaderContent = document.getElementById('preloader-content');
            const timeTravelContainer = document.getElementById('time-travel-container');
            const dateDisplay = document.getElementById('date-display');
            const finalVideoBtn = document.getElementById('final-video-btn');
            const finalVideo = document.getElementById('final-video');

            // --- Pre-loader Logic ---
            volumeBtn.addEventListener('click', () => {
                audio.play().catch(e => console.error("Audio play failed:", e));
                
                preloaderContent.style.transition = 'opacity 0.5s ease';
                preloaderContent.style.opacity = '0';

                setTimeout(() => {
                    preloaderContent.style.display = 'none';
                    timeTravelContainer.style.display = 'block';
                    startTimeTravel();
                }, 500);
            });

            function startTimeTravel() {
                const startDate = new Date();
                const endDate = new Date('2025-08-03T00:00:00');
                let currentDate = new Date(startDate);

                const interval = setInterval(() => {
                    const daysToAdd = Math.floor(Math.random() * 50) + 1;
                    const hoursToAdd = Math.floor(Math.random() * 100);
                    currentDate.setDate(currentDate.getDate() + daysToAdd);
                    currentDate.setHours(currentDate.getHours() + hoursToAdd);
                    
                    if (currentDate >= endDate) {
                        clearInterval(interval);
                        dateDisplay.textContent = 'AUG 03 2025';
                        setTimeout(() => {
                            document.getElementById('page-preloader').classList.remove('active');
                            startMainExperience();
                        }, 1500);
                    } else {
                        const month = currentDate.toLocaleString('en-US', { month: 'short' }).toUpperCase();
                        const day = String(currentDate.getDate()).padStart(2, '0');
                        const year = currentDate.getFullYear();
                        dateDisplay.textContent = `${month} ${day} ${year}`;
                    }
                }, 50);
            }

            // --- Main Experience Logic ---
            function startMainExperience() {
                currentPageIndex = 1; // Start from page-loader
                runSequence();
            }

            function createPetals() {
                const petalContainer = document.getElementById('petal-container');
                if (!petalContainer || petalContainer.children.length > 0) return;
                const petalCount = 20;
                for (let i = 0; i < petalCount; i++) {
                    const petal = document.createElement('div');
                    petal.className = 'petal';
                    petal.style.left = `${Math.random() * 100}vw`;
                    petal.style.animationDuration = `${Math.random() * 5 + 5}s`;
                    petal.style.animationDelay = `${Math.random() * 5}s`;
                    petal.style.transform = `scale(${Math.random() * 0.5 + 0.5})`;
                    petalContainer.appendChild(petal);
                }
            }

            function showPage(pageId) {
                const newPage = document.getElementById(pageId);
                if (newPage) {
                    pages.forEach(page => page.classList.remove('active'));
                    newPage.classList.add('active');
                }
            }

            function advanceToNextPage() {
                if (currentPageIndex < pageSequence.length - 1) {
                    currentPageIndex++;
                    runSequence();
                }
            }
            
            function lightCandles() {
                const flames = document.querySelectorAll('.flame-3d');
                flames.forEach((flame, index) => {
                    setTimeout(() => {
                        flame.classList.add('lit');
                    }, (index + 1) * 500); // Light candles one by one
                });
            }

            function initPage(pageId) {
                if (pageId === 'page-loader') createPetals();
                if (pageId === 'page-candle') {
                    lightCandles();
                    setTimeout(() => document.getElementById('cutMeBtn').classList.add('visible'), 4000); // Show button after candles are lit
                }
                if (pageId === 'page-photos' && !swiper) {
                    swiper = new Swiper('.swiper-container', {
                        effect: 'coverflow', grabCursor: true, centeredSlides: true, slidesPerView: 'auto',
                        loop: true,
                        autoplay: {
                            delay: 2500,
                            disableOnInteraction: false,
                            pauseOnMouseEnter: true,
                        },
                        coverflowEffect: { rotate: 50, stretch: 0, depth: 100, modifier: 1, slideShadows: true },
                        pagination: { el: '.swiper-pagination', clickable: true },
                    });
                }
                if (pageId === 'page-diary' && !typed) {
                    typed = new Typed('#diary-text', {
                        strings: ["Dearest Shriti,^1000\nOn your special day, I wanted to put together a little something to show you how much you mean to me.^500 Every moment with you is a cherished memory, a page in our beautiful story.^500 I hope this year brings you as much joy and happiness as you bring into my life every single day.^1000\nHappy Birthday, my love.^1500<br><br><span class='signature'>Yours, Abinash</span>"],
                        typeSpeed: 50, backSpeed: 25, startDelay: 500, loop: false, showCursor: true, cursorChar: '|',
                        onComplete: () => {
                            document.querySelector('.typed-cursor').style.display = 'none';
                            setTimeout(advanceToNextPage, 2000);
                        }
                    });
                }
                if (pageId === 'page-video') {
                    audio.pause();
                    finalVideo.currentTime = 0;
                    finalVideo.play().catch(e => console.error("Video play failed:", e));
                }
            }
            
            const cutMeBtn = document.getElementById('cutMeBtn');
            const wishMessage = document.getElementById('wishMessage');
            const cakeTopText = document.querySelector('#page-candle .cake-top-text');
            cutMeBtn.addEventListener('click', () => {
                cutMeBtn.style.opacity = '0';
                cutMeBtn.style.transform = 'translateX(-50%) translateY(50px)';
                cakeTopText.classList.add('hidden');
                setTimeout(() => wishMessage.classList.add('visible'), 300);
            });

            finalVideoBtn.addEventListener('click', () => {
                advanceToNextPage();
            });
            
            const pageSequence = [
                { id: 'page-preloader', duration: null },
                { id: 'page-loader', duration: 7000 },
                { id: 'page-candle', duration: 8000 },
                { id: 'page-photos', duration: 12000 },
                { id: 'page-diary', duration: null },
                { id: 'page-final', duration: null }, // Wait for click
                { id: 'page-video', duration: Infinity }
            ];

            function runSequence() {
                if (currentPageIndex >= pageSequence.length) return;
                const currentPage = pageSequence[currentPageIndex];
                showPage(currentPage.id);
                initPage(currentPage.id);
                if (currentPage.duration) {
                    setTimeout(advanceToNextPage, currentPage.duration);
                }
            }
        });
    </script>
</body>
</html>

